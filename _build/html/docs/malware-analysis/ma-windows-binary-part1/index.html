<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Malware Analysis 101: Introduction to Windows Binary (Stage 1) - Threat Hunting Book</title><meta property="og:title" content="Malware Analysis 101: Introduction to Windows Binary (Stage 1) - Threat Hunting Book"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png"/><meta property="og:image" content="/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png"/><link rel="stylesheet" href="/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Threat Hunting Book" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">Threat Hunting Book</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="WhoAmI" class="block break-words rounded py-2 grow cursor-pointer">WhoAmI</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Malware Analysis 101" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Malware Analysis 101</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:Rup8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Malware Analysis 101: Introduction to Windows Binary (Stage 1)" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/docs/malware-analysis/ma-windows-binary-part1">Malware Analysis 101: Introduction to Windows Binary (Stage 1)</a></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Hunts" class="block break-words rounded py-2 grow cursor-pointer">Hunts</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/PeterEdtu/peteredtu.github.io" title="GitHub Repository: PeterEdtu/peteredtu.github.io" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/PeterEdtu/peteredtu.github.io/edit/main/docs/malware_analysis/ma_windows_binary_part1.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Malware Analysis 101: Introduction to Windows Binary (Stage 1)</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">PeterEdtu</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><aside class="myst-admonition myst-admonition-warning my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Warning</div></div><div class="myst-admonition-body px-4 py-1"><p>This Page is still under construction... Read it with caution!</p></div></aside><h2 id="description" class="relative group"><span class="heading-text">Description</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#description" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This is the material presented in HTB France’s meetup about Malware Analysis.</p><h2 id="topics-covered" class="relative group"><span class="heading-text">Topics covered</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#topics-covered" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ol start="1"><li><p>Windows Executables lifecycle</p></li><li><p>Why Windows: Introduction to LOLBAS</p></li><li><p>Introduction to Windows API</p></li><li><p>Malware Families / Variants</p></li></ol><p>The full content of the presentation will come soon!</p><h2 id="payload-analysis-demo-1-mistake-or-feature" class="relative group"><span class="heading-text">Payload Analysis Demo 1: Mistake or Feature?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#payload-analysis-demo-1-mistake-or-feature" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Very basic Malware Analysis &amp; Triage on a delivered payload made for this demo.</p><aside class="myst-admonition myst-admonition-warning my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Warning</div></div><div class="myst-admonition-body px-4 py-1"><p>Demo Payloads are NOT available yet!</p></div></aside><img id="gJQ1CovrnT" style="margin:0 auto" src="/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png" alt="demo_flarevm" data-canonical-url="img/ma_part1_demo1_flarevm.png" class=""/><h3 id="static-analysis" class="relative group"><span class="heading-text">Static Analysis</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#static-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>PEstudio</strong></p><img id="AshE6kF4aa" style="margin:0 auto" src="/build/ma_part1_demo1_pestu-73c2302b91817b75a47949f69fb9cb22.png" alt="demo_pestudio" data-canonical-url="img/ma_part1_demo1_pestudio.png" class=""/><ol start="1"><li><p>First look at PEstudio data:</p></li></ol><ul><li><p>Binary seems to be compiled with Microsoft Visual Linker from C++</p></li><li><p>Size is 243200 bytes</p></li><li><p>Entropy is 6.184 which could mean that it is not packed, nor obfuscated / encrypted</p></li></ul><img id="V62JfkBZYZ" style="margin:0 auto" src="/build/ma_part1_demo1_pestu-d92a025a67ed334e3cf3acd4e84c573a.png" alt="demo_pestudio_2" data-canonical-url="img/ma_part1_demo1_pestudio_2.png" class=""/><ol start="2"><li><p>Sections:</p></li></ol><ul><li><p><code>raw-size</code> and <code>virtual-size</code> are close to the same value: we can confirm this <strong>Binary is not packed</strong></p></li><li><p>Size is “small”, maybe it is part of a stager or is a dropper?</p></li></ul><img id="kbohUGbnwT" style="margin:0 auto" src="/build/ma_part1_demo1_pestu-88ea084cd719438ea9bf665f887b5e27.png" alt="demo_pestudio_3" data-canonical-url="img/ma_part1_demo1_pestudio_3.png" class=""/><img id="O7wgaLl83X" style="margin:0 auto" src="/build/ma_part1_demo1_pestu-61706d76223be164d325ab80560fb92e.png" alt="demo_pestudio_4" data-canonical-url="img/ma_part1_demo1_pestudio_4.png" class=""/><ol start="3"><li><p>Module imports:</p></li></ol><ul><li><p>We can’t conclude anything from the imported libraries, but we are able to gather some new information we can use to anticipate its behavior during the dynamic analysis, and since the payload may not be obfuscated and is small-sized, static data should be pretty interesting:</p><ul><li><p><code>GetCurrentThreadId</code>, <code>GetCurrentThread</code> and<code>SetThreadStackGuarantee</code>: can imply <strong>Threads Manipulation</strong></p></li><li><p><code>GetEnvironmentVariableW</code>: getting environment variables of the system can imply <strong>Host Discovery</strong></p></li><li><p><code>WriteFile</code>, <code>FindNextFileW</code>, <code>FindFirstFileW</code> and <code>NtWriteFile</code>: writing and searching for files can imply <strong>Files Dropping and Files / Directories Discovery</strong></p></li></ul></li></ul><p>We can’t find any imports of functions to download resources online, which can imply that this payload might NOT be a dropper or a stager. But of course, this has to be confirmed.</p><p><strong>Detect It Easy</strong></p><p>We can now inspect the binary further by looking at the strings, maybe we will find some interesting things since the Binary is not obfuscated</p><img id="rFU0SErG0u" style="margin:0 auto" src="/build/ma_part1_demo1_die-51e99389aa54c365a6ec0610d30ef2bb.png" alt="demo_die_1" data-canonical-url="img/ma_part1_demo1_die.png" class=""/><p><code>Rust</code> compiler! I can already tell you we are cooked for the decompiling part.</p><img id="jeqL4cV50d" style="margin:0 auto" src="/build/ma_part1_demo1_die_2-ba8c18daf6e3cb1ff807139f1986c561.png" alt="demo_die_2" data-canonical-url="img/ma_part1_demo1_die_2.png" class=""/><img id="IndErmMuD6" style="margin:0 auto" src="/build/ma_part1_demo1_die_3-bfe3ee8c4da0893b9c0e7a6428b9aada.png" alt="demo_die_3" data-canonical-url="img/ma_part1_demo1_die_3.png" class=""/><p>We have found an interesting long string called <code>search_results_.txt</code>, which we should expect to see in the decompiled code and during execution.</p><p><strong>Quick view of Ghidra Decompiler</strong></p><p>Rust is... something when coming to decompilation. We can always decompile the Binary to Assembly, but what is magic with <strong>Ghidra</strong> is that it can produce Pseudo C code to help us performing code analysis. Here... Ghidra is clearly not made for Rust.</p><p>Let’s skip that for now. But here is a screenshot of me searching through the strings to find the one we have identified earlier. This Assembly experience wasn’t that interesting to explore so let’s skip that for now. We might need to do an entire course just for the Rust compiler. But don’t worry, in part 2 we’ll see more about decompiling Windows Binaries and do actual static code analysis!</p><img id="nCTctnn8eP" style="margin:0 auto" src="/build/ma_part1_demo1_ghidr-734a6b09237bae487a6f92b09fc9dee8.png" alt="demo_ghidra" data-canonical-url="img/ma_part1_demo1_ghidra.png" class=""/><h3 id="dynamic-analysis" class="relative group"><span class="heading-text">Dynamic Analysis</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dynamic-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Okay let’s take 2 seconds to think about what we want to see / confirm:</p><ul><li><p>No external resources should be accessed (no need for wireshark or INetSim - will be covered in part 2)</p></li><li><p>A file should be written at some point during execution</p></li><li><p>Something with searching for files should be there</p></li><li><p>Multi-threading or multi-processing could also be a thing</p></li><li><p>Something with environment variables: maybe for persistence?</p></li><li><p>And finally: what is this binary doing exacty?</p></li></ul><p><strong>Procmon filtered on the executable name</strong></p><img id="iUbiVR4P2i" style="margin:0 auto" src="/build/ma_part1_demo1_procm-66b8c395149b47e656268bc521fe9552.png" alt="demo_procmon1" data-canonical-url="img/ma_part1_demo1_procmon_1.png" class=""/><p>At the very beginning we can’t really see something special, except the creation of new Thread, the use of environment variables and some noise.</p><img id="lI9UtMZpme" style="margin:0 auto" src="/build/ma_part1_demo1_procm-920ce972fa1d909596009c3dae1f138b.png" alt="demo_procmon2" data-canonical-url="img/ma_part1_demo1_procmon_2.png" class=""/><p>Then when scrolling in the Procmon logs we find what looks like <strong>Files / Directories Enumeration</strong> activity. Basically, the binary is recursively searching through many folders and look for everything in them, starting at <code>AppData</code> folder. Earlier we saw a log showing us that the environment variables have been requested, it might be to get the full path of the <code>AppData</code> folder.</p><img id="eXfl7S91kG" style="margin:0 auto" src="/build/ma_part1_demo1_procm-d23cdb50ab6c1855c392a576a9b11b96.png" alt="demo_procmon3" data-canonical-url="img/ma_part1_demo1_procmon_3.png" class=""/><p>And here is the file creation event we were expecting, let’s have a look at its content!</p><img id="hVbJGHD91u" style="margin:0 auto" src="/build/ma_part1_demo1_file1-b6180a0db9152fbeca3985ab771882bc.png" alt="demo_procmon4" data-canonical-url="img/ma_part1_demo1_file1.png" class=""/><p>This <code>.txt</code> file seems to record information from the files the binary reads during the File / Dir Enumeration and then add it to this file. The full logic behind it is a blackbox, but now we know that this binary seems to act as the first stage of a stealer, trying to gather as much secret data as possible from the system, and stores it somewhere the user would not think of. Thus, makes it ready for <strong>Data Exfiltration</strong>.</p><p><strong>Procexp</strong></p><p>We can only see that the process for the binary is started and then stops once it is finished. Also, we can’t confirm multi-processing is a thing, also that there is any external connection.</p><p>No traces of Other processes or external connections.</p><p><strong>Autoruns: No persistence can be seen</strong></p><p>No traces of Autoruns.</p><h3 id="automated-static-analysis" class="relative group"><span class="heading-text">Automated Static Analysis</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#automated-static-analysis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we run Capa and see if we can confirm our hypothesis!</p><img id="waC5RSif8G" style="margin:0 auto" src="/build/ma_part1_demo1_capa-35509f4c72b1f6b74c2d9ee1e3fd2f5e.png" alt="demo_capa" data-canonical-url="img/ma_part1_demo1_capa.png" class=""/><p>The only thing we didn’t catch with this basic Triage was a XOR operation (see CAPA results) which does not seem to have a big impact during execution.</p><h3 id="demo-1-conclusion" class="relative group"><span class="heading-text">Demo 1: Conclusion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#demo-1-conclusion" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Verdict:</strong> Benign (not malicious)</p><p>Why? This binary is not exfiltrating information, only doing offline recon on files and saving it in a “search file” in the Temp folder. Is it a mistake or a feature?</p><div></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/docs/malware-analysis/ma-windows-binary-part1","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"hide_toc":false,"hide_footer_links":true,"hide_outline":false,"folders":true},"nav":[],"actions":[],"projects":[{"title":"Threat Hunting Book","authors":[{"id":"PeterEdtu","name":"PeterEdtu"}],"github":"https://github.com/PeterEdtu/peteredtu.github.io","copyright":"2025","toc":[{"file":"docs/index.md"},{"children":[{"file":"docs/whoami/aboutme.md"},{"file":"docs/whoami/contact.md"}],"title":"WhoAmI"},{"children":[{"file":"docs/malware_analysis/ma_windows_binary_part1.md"}],"title":"Malware Analysis 101"},{"children":[{"file":"docs/hunts/hunt_1.md"}],"title":"Hunts"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"WhoAmI"},{"slug":"docs.whoami.aboutme","title":"About Me","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"docs.whoami.contact","title":"Contact","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Malware Analysis 101"},{"slug":"docs.malware-analysis.ma-windows-binary-part1","title":"Malware Analysis 101: Introduction to Windows Binary (Stage 1)","description":"","date":"","thumbnail":"/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Hunts"},{"slug":"docs.hunts.hunt-1","title":"Hunt 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"hide_toc":false,"hide_footer_links":true,"hide_outline":false,"folders":true},"nav":[],"actions":[],"projects":[{"title":"Threat Hunting Book","authors":[{"id":"PeterEdtu","name":"PeterEdtu"}],"github":"https://github.com/PeterEdtu/peteredtu.github.io","copyright":"2025","toc":[{"file":"docs/index.md"},{"children":[{"file":"docs/whoami/aboutme.md"},{"file":"docs/whoami/contact.md"}],"title":"WhoAmI"},{"children":[{"file":"docs/malware_analysis/ma_windows_binary_part1.md"}],"title":"Malware Analysis 101"},{"children":[{"file":"docs/hunts/hunt_1.md"}],"title":"Hunts"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"WhoAmI"},{"slug":"docs.whoami.aboutme","title":"About Me","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"docs.whoami.contact","title":"Contact","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Malware Analysis 101"},{"slug":"docs.malware-analysis.ma-windows-binary-part1","title":"Malware Analysis 101: Introduction to Windows Binary (Stage 1)","description":"","date":"","thumbnail":"/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Hunts"},{"slug":"docs.hunts.hunt-1","title":"Hunt 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Article","sha256":"64f9dcbf7299c180250b68ccd76f070c039ebacccee18e2a394ac8a38ac3233b","slug":"docs.malware-analysis.ma-windows-binary-part1","location":"/docs/malware_analysis/ma_windows_binary_part1.md","dependencies":[],"frontmatter":{"title":"Malware Analysis 101: Introduction to Windows Binary (Stage 1)","content_includes_title":false,"authors":[{"id":"PeterEdtu","name":"PeterEdtu"}],"github":"https://github.com/PeterEdtu/peteredtu.github.io","copyright":"2025","numbering":{"title":{"offset":1}},"source_url":"https://github.com/PeterEdtu/peteredtu.github.io/blob/main/docs/malware_analysis/ma_windows_binary_part1.md","edit_url":"https://github.com/PeterEdtu/peteredtu.github.io/edit/main/docs/malware_analysis/ma_windows_binary_part1.md","thumbnail":"/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png","exports":[{"format":"md","filename":"ma_windows_binary_part1.md","url":"/build/ma_windows_binary_pa-7d2d6a8422e318074ec2d56428f0a72c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"cGvbwm6pn8"}],"key":"wIJy3PIwJV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This Page is still under construction... Read it with caution!","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RlygGg5OM4"}],"key":"Xbc99wB6pN"}],"key":"CVNUwHTb2a"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Description","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v91c2Qb9WJ"}],"identifier":"description","label":"Description","html_id":"description","implicit":true,"key":"a6qWfQkzmL"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This is the material presented in HTB France’s meetup about Malware Analysis.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rvKD0bhyRm"}],"key":"hxpkQDKQ6p"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Topics covered","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"czAKpXcuPt"}],"identifier":"topics-covered","label":"Topics covered","html_id":"topics-covered","implicit":true,"key":"fHhITrLhWU"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Windows Executables lifecycle","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"FylJQEFB7a"}],"key":"x4jr2WstdF"}],"key":"g5rbCoVJG5"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Why Windows: Introduction to LOLBAS","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"h8xOskQ3nz"}],"key":"NBGB9HXRMy"}],"key":"uREcA4YMed"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Introduction to Windows API","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kJ1LGGZIru"}],"key":"WSsHYBb8C5"}],"key":"pCCGfqDxza"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Malware Families / Variants","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NOQSPz2WD9"}],"key":"imHneEt3ZH"}],"key":"YnYCCHWABS"}],"key":"V7EicJkfZc"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The full content of the presentation will come soon!","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rRs4JUKKIk"}],"key":"W1NhoxHNaM"},{"type":"heading","depth":2,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Payload Analysis Demo 1: Mistake or Feature?","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"y0IVHFTbyV"}],"identifier":"payload-analysis-demo-1-mistake-or-feature","label":"Payload Analysis Demo 1: Mistake or Feature?","html_id":"payload-analysis-demo-1-mistake-or-feature","implicit":true,"key":"F9WokKCTaC"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Very basic Malware Analysis \u0026 Triage on a delivered payload made for this demo.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ITnvQLCS8v"}],"key":"ZUfp7kENSY"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"t9HSZxUWco"}],"key":"Ah92kihlaN"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Demo Payloads are NOT available yet!","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"EmN72dLi6p"}],"key":"OUNHD1UiUJ"}],"key":"vQOXPin3In"},{"type":"image","url":"/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png","alt":"demo_flarevm","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"gJQ1CovrnT","urlSource":"img/ma_part1_demo1_flarevm.png"},{"type":"heading","depth":3,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Static Analysis","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"HGvIZZv9oY"}],"identifier":"static-analysis","label":"Static Analysis","html_id":"static-analysis","implicit":true,"key":"dmZCf9sS85"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"PEstudio","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"dfVMIKVl8C"}],"key":"Bwv7cJt8NI"}],"key":"dQxGQqIlFR"},{"type":"image","url":"/build/ma_part1_demo1_pestu-73c2302b91817b75a47949f69fb9cb22.png","alt":"demo_pestudio","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"AshE6kF4aa","urlSource":"img/ma_part1_demo1_pestudio.png"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"First look at PEstudio data:","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"FGuTPTK5N4"}],"key":"F7wCZKIyRT"}],"key":"HwaklTk14u"}],"key":"FbBJFRKXs0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Binary seems to be compiled with Microsoft Visual Linker from C++","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FKHPHhGq39"}],"key":"fDPTKojnZu"}],"key":"ggP41gbVti"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Size is 243200 bytes","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"wbFjeJot4Q"}],"key":"f9TZplCr5E"}],"key":"leV0k3ZmXb"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Entropy is 6.184 which could mean that it is not packed, nor obfuscated / encrypted","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"WosjPugTG9"}],"key":"TvVQ25NjkA"}],"key":"A68gixPrvX"}],"key":"I5c3TP6hqJ"},{"type":"image","url":"/build/ma_part1_demo1_pestu-d92a025a67ed334e3cf3acd4e84c573a.png","alt":"demo_pestudio_2","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"V62JfkBZYZ","urlSource":"img/ma_part1_demo1_pestudio_2.png"},{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sections:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"PWLvU2bJaz"}],"key":"B37gnCegNH"}],"key":"YleQGPXKoM"}],"key":"MA8dHdWJxo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":42,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"raw-size","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"zRthoi7Z74"},{"type":"text","value":" and ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"uv8JlaploW"},{"type":"inlineCode","value":"virtual-size","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"R9oKn1GzXL"},{"type":"text","value":" are close to the same value: we can confirm this ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"VUMTU3DjvR"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Binary is not packed","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"lapuC85wGX"}],"key":"k0G4DaMdSz"}],"key":"Pm2VudggBh"}],"key":"xSjlIksCM8"},{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Size is “small”, maybe it is part of a stager or is a dropper?","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"nM0GmIO45f"}],"key":"LwZTFEU2lF"}],"key":"gHhqDGHSr4"}],"key":"hJAns10sb2"},{"type":"image","url":"/build/ma_part1_demo1_pestu-88ea084cd719438ea9bf665f887b5e27.png","alt":"demo_pestudio_3","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"kbohUGbnwT","urlSource":"img/ma_part1_demo1_pestudio_3.png"},{"type":"image","url":"/build/ma_part1_demo1_pestu-61706d76223be164d325ab80560fb92e.png","alt":"demo_pestudio_4","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"O7wgaLl83X","urlSource":"img/ma_part1_demo1_pestudio_4.png"},{"type":"list","ordered":true,"start":3,"spread":false,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Module imports:","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"fZjlGTkHjG"}],"key":"WSD7CsHs0L"}],"key":"BXVKSAzrzm"}],"key":"PCVi2rjji6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":51,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We can’t conclude anything from the imported libraries, but we are able to gather some new information we can use to anticipate its behavior during the dynamic analysis, and since the payload may not be obfuscated and is small-sized, static data should be pretty interesting:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"qy09w21q6Y"}],"key":"Du5XM2o7Mi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":52,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"GetCurrentThreadId","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"lhIvQR4BSZ"},{"type":"text","value":", ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"lmgZmlDSkp"},{"type":"inlineCode","value":"GetCurrentThread","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"ieNl3fH7Zu"},{"type":"text","value":" and","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"pIPZwDuJik"},{"type":"inlineCode","value":"SetThreadStackGuarantee","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"DRf4KBTZqL"},{"type":"text","value":": can imply ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"ZhIZfDgWNJ"},{"type":"strong","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Threads Manipulation","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"EUzjVz3TcI"}],"key":"nPJpfilXFi"}],"key":"Pguqd7QMrp"}],"key":"dJbJyVyueQ"},{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"GetEnvironmentVariableW","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"rnoH4kQ6HX"},{"type":"text","value":": getting environment variables of the system can imply ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"uJoi1LK2si"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Host Discovery","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Nnay3zIdca"}],"key":"D5hvAy9H8o"}],"key":"U1MpnwozBd"}],"key":"k1ezolfX1W"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"WriteFile","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"qm7Syeq7sF"},{"type":"text","value":", ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"zQntn34W8y"},{"type":"inlineCode","value":"FindNextFileW","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"BJWhzMsIp4"},{"type":"text","value":", ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"VY8WX8V3sE"},{"type":"inlineCode","value":"FindFirstFileW","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"mLVhfTbtyi"},{"type":"text","value":" and ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"FeSFL75WKO"},{"type":"inlineCode","value":"NtWriteFile","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"gelX0yfElF"},{"type":"text","value":": writing and searching for files can imply ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"OFt0XlWm5j"},{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Files Dropping and Files / Directories Discovery","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"BwPqGC3Jxn"}],"key":"K4pIertG4I"}],"key":"kbo0lIYDVP"}],"key":"b455DbgxpY"}],"key":"YgePIEkc6w"}],"key":"FCG6hO2pm9"}],"key":"ZzjYuNosSd"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"We can’t find any imports of functions to download resources online, which can imply that this payload might NOT be a dropper or a stager. But of course, this has to be confirmed.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"yU0mXVZLJf"}],"key":"SQ6FzQFO7l"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"strong","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Detect It Easy","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"bUnYP8INXf"}],"key":"N0TWHhwT0w"}],"key":"vR6xbgO1zJ"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"We can now inspect the binary further by looking at the strings, maybe we will find some interesting things since the Binary is not obfuscated","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"zFmYPyHpWW"}],"key":"V3g4MbNCye"},{"type":"image","url":"/build/ma_part1_demo1_die-51e99389aa54c365a6ec0610d30ef2bb.png","alt":"demo_die_1","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"rFU0SErG0u","urlSource":"img/ma_part1_demo1_die.png"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"inlineCode","value":"Rust","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"yZuIU07mh8"},{"type":"text","value":" compiler! I can already tell you we are cooked for the decompiling part.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"i2SrD8AerO"}],"key":"vU0olUbMkA"},{"type":"image","url":"/build/ma_part1_demo1_die_2-ba8c18daf6e3cb1ff807139f1986c561.png","alt":"demo_die_2","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"urlSource":"img/ma_part1_demo1_die_2.png","key":"jeqL4cV50d"},{"type":"image","url":"/build/ma_part1_demo1_die_3-bfe3ee8c4da0893b9c0e7a6428b9aada.png","alt":"demo_die_3","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"IndErmMuD6","urlSource":"img/ma_part1_demo1_die_3.png"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"We have found an interesting long string called ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"eTG0bymTc2"},{"type":"inlineCode","value":"search_results_.txt","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"oEfYd7Ze62"},{"type":"text","value":", which we should expect to see in the decompiled code and during execution.","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"BU5qob9Eg7"}],"key":"tDZ9JIaSaX"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Quick view of Ghidra Decompiler","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"yN1oEqeWAr"}],"key":"FK6gDelzz7"}],"key":"F8ReZVHaDe"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Rust is... something when coming to decompilation. We can always decompile the Binary to Assembly, but what is magic with ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"Y8WhjC1FeF"},{"type":"strong","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Ghidra","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"wKebBIhYUh"}],"key":"bHi1aSv3YA"},{"type":"text","value":" is that it can produce Pseudo C code to help us performing code analysis. Here... Ghidra is clearly not made for Rust.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"ps6fj3inIs"}],"key":"Z0kUYOUjkF"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Let’s skip that for now. But here is a screenshot of me searching through the strings to find the one we have identified earlier. This Assembly experience wasn’t that interesting to explore so let’s skip that for now. We might need to do an entire course just for the Rust compiler. But don’t worry, in part 2 we’ll see more about decompiling Windows Binaries and do actual static code analysis!","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"uJrzcLv0GY"}],"key":"GND6xcS57X"},{"type":"image","url":"/build/ma_part1_demo1_ghidr-734a6b09237bae487a6f92b09fc9dee8.png","alt":"demo_ghidra","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"nCTctnn8eP","urlSource":"img/ma_part1_demo1_ghidra.png"},{"type":"heading","depth":3,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Dynamic Analysis","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"QccB4xNkBZ"}],"identifier":"dynamic-analysis","label":"Dynamic Analysis","html_id":"dynamic-analysis","implicit":true,"key":"JV0icbyxdP"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Okay let’s take 2 seconds to think about what we want to see / confirm:","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"ptIGLeMuO7"}],"key":"HkYQI59l86"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"No external resources should be accessed (no need for wireshark or INetSim - will be covered in part 2)","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"IAl20wVqX3"}],"key":"FCApBJRkDA"}],"key":"TwydyC64v5"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A file should be written at some point during execution","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"EA3jC90XCS"}],"key":"zOZi4DXrXR"}],"key":"q9PrOkJdg7"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Something with searching for files should be there","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"ChTpz390TV"}],"key":"ILsGJWoS4H"}],"key":"p0bQMXqCoq"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Multi-threading or multi-processing could also be a thing","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"AcLdorJncf"}],"key":"F4pQaqMNaY"}],"key":"RfqQnnm5fZ"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Something with environment variables: maybe for persistence?","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"AdxlOtAWkq"}],"key":"bwGkNOlNHv"}],"key":"owsfwYTQBm"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"And finally: what is this binary doing exacty?","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"fD1GozRdsG"}],"key":"wLOXFEAxut"}],"key":"Dw6sOIrUhg"}],"key":"LFOQJeZIav"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"strong","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Procmon filtered on the executable name","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"WRYEswI6Jd"}],"key":"i2t8wJmg2a"}],"key":"ViLE76rgud"},{"type":"image","url":"/build/ma_part1_demo1_procm-66b8c395149b47e656268bc521fe9552.png","alt":"demo_procmon1","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"iUbiVR4P2i","urlSource":"img/ma_part1_demo1_procmon_1.png"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"At the very beginning we can’t really see something special, except the creation of new Thread, the use of environment variables and some noise.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"j4Y27OjEHX"}],"key":"YTFIXLLZDm"},{"type":"image","url":"/build/ma_part1_demo1_procm-920ce972fa1d909596009c3dae1f138b.png","alt":"demo_procmon2","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"lI9UtMZpme","urlSource":"img/ma_part1_demo1_procmon_2.png"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Then when scrolling in the Procmon logs we find what looks like ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"dgYKrEPamN"},{"type":"strong","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Files / Directories Enumeration","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"LhNHIoqxt8"}],"key":"Y5zzCWpEUs"},{"type":"text","value":" activity. Basically, the binary is recursively searching through many folders and look for everything in them, starting at ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"ioA2cXGF5e"},{"type":"inlineCode","value":"AppData","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"oW1jybVVVN"},{"type":"text","value":" folder. Earlier we saw a log showing us that the environment variables have been requested, it might be to get the full path of the ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"e4R5UNZZjy"},{"type":"inlineCode","value":"AppData","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"PyMsL6OmDX"},{"type":"text","value":" folder.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"xWCMqPYqrg"}],"key":"TfJlf09gSb"},{"type":"image","url":"/build/ma_part1_demo1_procm-d23cdb50ab6c1855c392a576a9b11b96.png","alt":"demo_procmon3","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"eXfl7S91kG","urlSource":"img/ma_part1_demo1_procmon_3.png"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"And here is the file creation event we were expecting, let’s have a look at its content!","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"w99l9EcQUh"}],"key":"yI5O5w2YnX"},{"type":"image","url":"/build/ma_part1_demo1_file1-b6180a0db9152fbeca3985ab771882bc.png","alt":"demo_procmon4","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"hVbJGHD91u","urlSource":"img/ma_part1_demo1_file1.png"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"This ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"zoceHWEsaD"},{"type":"inlineCode","value":".txt","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"ZyAtpsJcDW"},{"type":"text","value":" file seems to record information from the files the binary reads during the File / Dir Enumeration and then add it to this file. The full logic behind it is a blackbox, but now we know that this binary seems to act as the first stage of a stealer, trying to gather as much secret data as possible from the system, and stores it somewhere the user would not think of. Thus, makes it ready for ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"X9ySqZ8Kqw"},{"type":"strong","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Data Exfiltration","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"fXx8lMptob"}],"key":"Dm4uimM46p"},{"type":"text","value":".","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"gCf1lY03EB"}],"key":"sZseAJNSRV"},{"type":"paragraph","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Procexp","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"x7GBKHCd86"}],"key":"xVN6OyEWEj"}],"key":"Orgc4dVGKX"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"We can only see that the process for the binary is started and then stops once it is finished. Also, we can’t confirm multi-processing is a thing, also that there is any external connection.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"TWi8Tpg8Ru"}],"key":"NeBXHDSOXD"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"No traces of Other processes or external connections.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"hN4OpPjBcA"}],"key":"ZfYZS5jmUD"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"strong","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Autoruns: No persistence can be seen","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"gEgiqJ9YwU"}],"key":"SOMsBiQGon"}],"key":"v1E22F2sHB"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"No traces of Autoruns.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"Da6O5IEG9A"}],"key":"Hs2RlY2z8G"},{"type":"heading","depth":3,"position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Automated Static Analysis","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"e7bkdOwAfZ"}],"identifier":"automated-static-analysis","label":"Automated Static Analysis","html_id":"automated-static-analysis","implicit":true,"key":"NgqQJVKgnE"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Now we run Capa and see if we can confirm our hypothesis!","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"r5leaBRiE6"}],"key":"t7Ymc9SE2Q"},{"type":"image","url":"/build/ma_part1_demo1_capa-35509f4c72b1f6b74c2d9ee1e3fd2f5e.png","alt":"demo_capa","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"waC5RSif8G","urlSource":"img/ma_part1_demo1_capa.png"},{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"The only thing we didn’t catch with this basic Triage was a XOR operation (see CAPA results) which does not seem to have a big impact during execution.","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"DDI0CoWZho"}],"key":"q2DVwTVVId"},{"type":"heading","depth":3,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Demo 1: Conclusion","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Zz0Z3Ofgmv"}],"identifier":"demo-1-conclusion","label":"Demo 1: Conclusion","html_id":"demo-1-conclusion","implicit":true,"key":"L4aiXdfGZc"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Verdict:","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"tAw7E7zmAV"}],"key":"ljrwoM2Vna"},{"type":"text","value":" Benign (not malicious)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"QzjsLFiIkB"}],"key":"HjvDooFFtj"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Why? This binary is not exfiltrating information, only doing offline recon on files and saving it in a “search file” in the Temp folder. Is it a mistake or a feature?","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"Zgodbf9GJm"}],"key":"p7TQQoDZSK"}],"key":"P0uevv4Ogq"}],"key":"c8o6oJEbIw"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Contact","url":"/docs/whoami/contact","group":"WhoAmI"},"next":{"title":"Hunt 1","url":"/docs/hunts/hunt-1","group":"Hunts"}}},"domain":"http://localhost:3000"},"project":{"title":"Threat Hunting Book","authors":[{"id":"PeterEdtu","name":"PeterEdtu"}],"github":"https://github.com/PeterEdtu/peteredtu.github.io","copyright":"2025","toc":[{"file":"docs/index.md"},{"children":[{"file":"docs/whoami/aboutme.md"},{"file":"docs/whoami/contact.md"}],"title":"WhoAmI"},{"children":[{"file":"docs/malware_analysis/ma_windows_binary_part1.md"}],"title":"Malware Analysis 101"},{"children":[{"file":"docs/hunts/hunt_1.md"}],"title":"Hunts"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"WhoAmI"},{"slug":"docs.whoami.aboutme","title":"About Me","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"docs.whoami.contact","title":"Contact","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Malware Analysis 101"},{"slug":"docs.malware-analysis.ma-windows-binary-part1","title":"Malware Analysis 101: Introduction to Windows Binary (Stage 1)","description":"","date":"","thumbnail":"/build/ma_part1_demo1_flare-df8a7d5a4a8450feaaeeb8812baa76a3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Hunts"},{"slug":"docs.hunts.hunt-1","title":"Hunt 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-ED236704.js";
import * as route0 from "/build/root-ZJOPFBMV.js";
import * as route1 from "/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>